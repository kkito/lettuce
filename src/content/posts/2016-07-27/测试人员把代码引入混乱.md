## 测试人员把代码引向混乱

一次bug fix过程中的一些思考体悟

## 大体的需求

- 学生登录系统可以看到自己的班级和上课情况
- 学生可以额外参加课外兴趣班
- 参加课外兴趣班的学生，登录系统，就出先提示入口，通过入口进入兴趣班页面
- 兴趣班有开始班级时间，只有开始了才能看到

## 设计的思路

- 学生和班级略
- 课外兴趣班 , 有开班时间
- 学生参加课外兴趣班，在学生上设置兴趣班的类型，一旦学生参加兴趣班就增加这类型

## 流程和问题

- 学生登录，发现有兴趣班状态，则显示入口链接，否则没有
- 测试人员报bug，有学生刚参加了一个兴趣班，但兴趣班尚未开始，所有这个入口不能显示。
- 修复，返回学生类型时，如果是兴趣班类型则看有没有已经发布的课程，如果有返回兴趣班类型，没有返回普通班类型

## 思考

- Bug本身不痛不痒，就算有入口进入也没有任何副作用。实际更好的体验我认为应该让学生进入，显示有个待开始的兴趣班，具体信息略去。
- 上述的修复，实际打破了原有的设计思路。如果直接判断有无发布课程，何苦要去记录一个兴趣班的类型呢？
- 系统中额外多出了一种状态。普通学生，兴趣班已开课学生，兴趣班未开课学生，增加了复杂度。
- Bug修复比较简单。

## 灾难

- 之前修复也是犹豫再三到底要不要修，比较简单。也不想和测试人员、产品去扯就直接修了。
- 过了一周另一个bug报上来，有学生参加了兴趣班，上了一节课后中途退班了。结果他登陆看不到兴趣班入口。
- 要修复实际也很简单，在原先的代码上增加判断有没有上过课记录即可。
- 这是个无底洞，今天把这儿填上，明天还有一堆别的问题。找一堆人讨论，删除之前的逻辑，直接判断是否是兴趣班类型，出现入口。


## 再思考

- 设计本身要符合业务
- 小的细节也有可能是关键的业务
- Keep it Simple Stupid 
- 项目代码烂，逻辑乱出现很多是在一个坑一个坑填之后才出现的，单看某一个坑都能说得过去，但越积越多之后，就有问题。而且积重难返。
- 开发的过程，顺着设计思路。但Bug fix的过程有可能把之前的设计思路给打破。

## 重点Bug fix过程导致代码设计问题

- 需求出来会花很多时间设计思考，但bug出来不会花时间去再思考
- Bug修复过程中，很多心态是怎么尽快的修复，而非整体的完美方案。
- 测试人员找到Bug之后很难说服他
- Bug一个一个出现，没有统一，没有时间性。温水煮青蛙，一点点走上不归路。
- 某一个小bug，走了一条违背设计思路的方案之后，后续问题会越来越多。
